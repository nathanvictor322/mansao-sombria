<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Mansão Abandonada - Jogo de Terror</title>
    <style>
        /* Reset e estilos gerais */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #0a0a0a;
            color: #e0e0e0;
            line-height: 1.6;
            overflow-y: auto;
            min-height: 100vh;
            padding: 10px;
            background-image: radial-gradient(#1a1a1a 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #111111;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
            border: 1px solid #333;
            min-height: 95vh;
            overflow-y: auto;
            position: relative;
        }

        /* Cabeçalho do jogo */
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
            position: relative;
        }

        .header h1 {
            color: #8b0000;
            font-size: 2.2rem;
            text-shadow: 0 0 10px rgba(139, 0, 0, 0.5);
            margin-bottom: 8px;
            letter-spacing: 1px;
        }

        .header .subtitle {
            color: #aaa;
            font-style: italic;
        }

        /* Indicador de sanidade */
        .sanity-container {
            margin-bottom: 20px;
            background-color: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #333;
        }

        .sanity-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: #aaa;
        }

        .sanity-bar {
            height: 20px;
            background-color: #222;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            border: 1px solid #444;
        }

        .sanity-fill {
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, #0a5, #5f5, #0a5);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .sanity-low {
            background: linear-gradient(90deg, #a00, #f55, #a00);
        }

        /* Área da cena */
        .scene-container {
            margin-bottom: 25px;
            background-color: #151515;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #333;
            min-height: 200px;
            position: relative;
        }

        .scene-text {
            font-size: 1.2rem;
            line-height: 1.7;
            color: #ddd;
            white-space: pre-line;
            margin-bottom: 20px;
        }

        .scene-text::first-letter {
            font-size: 1.5em;
            color: #8b0000;
        }

        /* Opções de escolha */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        .option-button {
            background-color: #222;
            color: #e0e0e0;
            border: 1px solid #444;
            border-radius: 5px;
            padding: 15px;
            font-size: 1.1rem;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .option-button:hover, .option-button:focus {
            background-color: #2a2a2a;
            border-color: #8b0000;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }

        .option-button:active {
            transform: translateY(0);
        }

        .option-button::before {
            content: ">";
            position: absolute;
            left: 10px;
            color: #8b0000;
            font-weight: bold;
        }

        .option-button span {
            margin-left: 20px;
            display: block;
        }

        /* Tela de game over */
        .game-over {
            text-align: center;
            padding: 30px;
            background-color: #0f0f0f;
            border-radius: 5px;
            border: 2px solid #8b0000;
        }

        .game-over h2 {
            color: #8b0000;
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(139, 0, 0, 0.7);
        }

        .game-over p {
            font-size: 1.3rem;
            margin-bottom: 30px;
            color: #ccc;
        }

        .restart-button {
            background-color: #8b0000;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 15px 30px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .restart-button:hover {
            background-color: #a00;
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(139, 0, 0, 0.7);
        }

        /* Efeitos visuais */
        .flicker {
            animation: flicker 0.3s infinite alternate;
        }

        @keyframes flicker {
            from { opacity: 0.8; }
            to { opacity: 1; }
        }

        .hidden {
            display: none;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                min-height: 90vh;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .scene-text {
                font-size: 1.1rem;
            }
            
            .option-button {
                padding: 12px;
                font-size: 1rem;
            }
            
            .sanity-container {
                padding: 10px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .scene-text {
                font-size: 1rem;
            }
            
            .option-button {
                padding: 10px;
            }
        }

        /* Efeito de digitação para o texto da cena */
        .typing {
            overflow: hidden;
            border-right: 2px solid #8b0000;
            white-space: pre-line;
            animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #8b0000 }
        }

        /* Estilo para situações de perigo */
        .danger {
            border-color: #ff0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .danger-text {
            color: #ff6666;
        }

        .escape-option {
            background-color: #330000;
            border-color: #ff0000;
        }

        .escape-option:hover {
            background-color: #550000;
        }
    </style>
</head>
<body>
    <div class="container" id="game-container">
        <div class="header">
            <h1>A MANSÃO ABANDONADA</h1>
            <p class="subtitle">Um jogo de terror psicológico</p>
        </div>
        
        <div class="sanity-container">
            <div class="sanity-label">
                <span>SANIDADE MENTAL</span>
                <span id="sanity-value">100%</span>
            </div>
            <div class="sanity-bar">
                <div class="sanity-fill" id="sanity-fill"></div>
            </div>
        </div>
        
        <div class="scene-container" id="scene-container">
            <div class="scene-text" id="scene-text">
                Carregando...
            </div>
            <div class="options-container" id="options-container">
                <!-- Opções serão inseridas aqui pelo JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Estado do jogo
        let sanity = 100;
        let gameState = {};
        let previousScene = null; // Para armazenar a cena anterior
        
        // Cenas do jogo
        const scenes = {
            start: {
                text: `Há três semanas, minha irmã Clara desapareceu. A última pista que a polícia encontrou foi um diário em seu quarto, com anotações sobre uma mansão abandonada nas colinas. Eles abandonaram o caso por falta de evidências, mas eu não posso fazer o mesmo.

Esta noite, estou aqui, diante do portão enferrujado da Mansão Blackwood. O ar está frio e pesado, e uma névoa fina envolve a propriedade. Se Clara veio até aqui, preciso descobrir o que aconteceu.

Minha lanterna ilumina apenas alguns metros à frente. O portão range quando o empurro. É agora ou nunca.`,
                options: [
                    { text: "Entrar pela porta da frente", next: "entrada", sanityChange: -5 },
                    { text: "Contornar a mansão e procurar uma entrada dos fundos", next: "fundos", sanityChange: -3 },
                    { text: "Investigar o jardim primeiro", next: "jardim", sanityChange: -2 }
                ]
            },
            
            entrada: {
                text: `A porta principal está emperrada, mas cede com um empurrão. O interior é ainda mais escuro que o exterior. O cheiro de mofo e madeira podre invade minhas narinas.

No hall de entrada, uma escada majestosa se ergue à minha frente, mas muitos degraus estão quebrados. À esquerda, uma porta entreaberta revela o que parece ser uma biblioteca. À direita, um corredor escuro leva mais fundo na mansão.

Ouço um rangido vindo de cima, como se alguém tivesse pisado em uma tábua solta.`,
                options: [
                    { text: "Subir a escada", next: "escada", condition: () => sanity > 30, sanityChange: -10 },
                    { text: "Entrar na biblioteca", next: "biblioteca", sanityChange: -5 },
                    { text: "Seguir pelo corredor escuro", next: "corredor", sanityChange: -8 },
                    { text: "Voltar para fora e tentar outra entrada", next: "fundos", sanityChange: -2 }
                ]
            },
            
            fundos: {
                text: `Contorno a mansão, pisando em folhas secas e galhos quebrados. As janelas estão todas escuras, exceto uma no andar superior, onde uma luz fraca parece tremular.

Na parte de trás, encontro uma porta de serviço meio arrombada. Dentro, vejo uma cozinha em ruínas. Um cheiro estranho, como de carne estragada, paira no ar.

No balcão, vejo algo que faz meu coração acelerar: um pingente de prata igual ao que dei para Clara em seu aniversário.`,
                options: [
                    { text: "Entrar pela cozinha", next: "cozinha", sanityChange: -7 },
                    { text: "Olhar pela janela com luz", next: "janela", condition: () => sanity > 40, sanityChange: -12 },
                    { text: "Voltar para a frente da mansão", next: "entrada", sanityChange: -3 },
                    { text: "Gritar o nome de Clara", next: "gritar", sanityChange: -15 }
                ]
            },
            
            jardim: {
                text: `O jardim está abandonado há décadas. Estatuas quebradas e árvores retorcidas criam sombras ameaçadoras. Minha lanterna revela algo perturbador: marcas de arrasto no chão lamacento, que levam até uma pequena construção nos fundos do jardim.

De repente, ouço um sussurro vindo dos arbustos. Não consigo distinguir palavras, mas a voz parece familiar.

Uma lápide inclinada chama minha atenção. A inscrição está desgastada, mas consigo ler "Aqueles que buscam respostas...". O resto está ilegível.`,
                options: [
                    { text: "Seguir as marcas de arrasto", next: "construcao", sanityChange: -10 },
                    { text: "Investigar os sussurros nos arbustos", next: "arbustos", sanityChange: -12 },
                    { text: "Examinar a lápide mais de perto", next: "lapide", condition: () => sanity > 50, sanityChange: -15 },
                    { text: "Voltar para a entrada da mansão", next: "entrada", sanityChange: -2 }
                ]
            },
            
            biblioteca: {
                text: `A biblioteca é uma sala enorme, com estantes que vão do chão ao teto. A maioria dos livros está apodrecendo, mas alguns parecem intactos. Em uma mesa no centro, um livro está aberto.

Ao me aproximar, vejo que são anotações escritas à mão. A caligrafia é de Clara! Ela escreve sobre "rituais antigos" e "entidades que habitam os limiares entre mundos".

De repente, a porta da biblioteca bate sozinha. Estou trancado aqui dentro.`,
                options: [
                    { text: "Ler mais do diário de Clara", next: "diario", sanityChange: -10 },
                    { text: "Procurar uma saída", next: "procura_saida", sanityChange: -8 },
                    { text: "Gritar por ajuda", next: "gritar_biblioteca", sanityChange: -12 },
                    { text: "Examinar as estantes em busca de algo útil", next: "estantes", condition: () => sanity > 35, sanityChange: -7 }
                ]
            },
            
            cozinha: {
                text: `A cozinha é um caos. Pratos quebrados cobrem o chão, e os armários estão vazios, exceto por alguns vidros com conteúdo indeterminado. O cheiro de decomposição é mais forte aqui.

Encontro o pingente de Clara em cima da mesa. Está frio ao toque. Quando o pego, ouço passadas acima de mim, como se alguém estivesse andando rápido.

Então vejo algo pior: na parede, atrás de um armário deslocado, há marcas de arranhões. E palavras riscadas com algo escuro: "ELE VIVE NAS PAREDES".`,
                options: [
                    { text: "Sair correndo da cozinha", next: "corredor", sanityChange: -10 },
                    { text: "Investigar as marcas na parede", next: "marcas_parede", sanityChange: -15 },
                    { text: "Procurar onde vão os passos", next: "passos", sanityChange: -12 },
                    { text: "Procurar uma arma para se defender", next: "arma", condition: () => sanity > 25, sanityChange: -8 }
                ]
            },
            
            escada: {
                text: `Cada degrau range sob meus pés. A escuridão no andar superior é absoluta, engolindo a luz da minha lanterna. Quando chego ao topo, vejo um longo corredor com várias portas.

De repente, todas as portas se abrem ao mesmo tempo com um rangido ensurdecedor. Do quarto ao final do corredor, uma sombra se move. Não é humana - é muito alta, muito magra.

Ela se vira para mim, mas não tem rosto, apenas um vazio escuro. Minha mente grita para eu correr, mas minhas pernas não respondem.`,
                options: [
                    { text: "Correr de volta escada abaixo", next: "entrada", sanityChange: -20 },
                    { text: "Entrar no primeiro quarto à direita", next: "quarto1", sanityChange: -15 },
                    { text: "Enfrentar a sombra", next: "confronto_sombra", condition: () => sanity > 70, sanityChange: -30 },
                    { text: "Ficar parado e observar", next: "observar", sanityChange: -25 }
                ]
            },
            
            diario: {
                text: `Folheio as páginas do diário de Clara. Suas anotações ficam cada vez mais desesperadas:

"Ele me encontra nos sonhos. Diz que quer me mostrar a verdade por trás do véu."
"Hoje descobri o que aconteceu com os antigos moradores. Eles não se foram. Ainda estão aqui, presos entre as paredes."
"Encontrei o quarto do ritual. Se eu completar a cerimônia, posso trazê-los de volta. Ou talvez me juntar a eles."

A última entrada é de três semanas atrás, no dia em que ela desapareceu: "Esta noite vou enfrentar o que habita no sótão. Se não voltar, irmão, por favor não me procure. É tarde demais para mim."`,
                options: [
                    { text: "Procurar o sótão", next: "sotao", sanityChange: -20 },
                    { text: "Sair da biblioteca e voltar para casa", next: "desistir", sanityChange: -25 },
                    { text: "Continuar procurando por mais pistas", next: "estantes", sanityChange: -10 }
                ]
            },
            
            sotao: {
                text: `Encontro uma escada estreita que leva ao sótão. O ar aqui é pesado e gelado. No centro da sala, um círculo está desenhado no chão com um pó branco. Velas negras, já consumidas, formam um pentagrama.

No centro do círculo, está Clara. Ela está imóvel, sentada de costas para mim.

"Clara?" sussurro.

Ela se vira lentamente. Seus olhos são completamente pretos, e um sorriso largo se abre em seu rosto, muito largo para ser humano.

"Finalmente você vejo", diz uma voz que é a dela, mas ao mesmo tempo não é. "Agora podemos ficar juntos para sempre."`,
                options: [
                    { text: "Correr em direção a ela", next: "armadilha", sanityChange: -20 },
                    { text: "Recuar e tentar quebrar o círculo", next: "quebrar_circulo", condition: () => sanity > 30, sanityChange: -15 },
                    { text: "Gritar seu nome com força", next: "gritar_nome", sanityChange: -18 }
                ]
            },
            
            quebrar_circulo: {
                text: `Pulso para fora do círculo e começo a apagar as marcas no chão com meus pés. Clara (ou o que quer que ela tenha se tornado) grita - um som agudo e não humano.

As velas se acendem sozinhas com chamas verdes. A sala começa a tremer. Mas as marcas do círculo estão se desfazendo.

"Você não pode nos separar!", a coisa com o rosto de minha irmã grita. Mas já posso ver seu corpo tremendo, como se estivesse desfocado.

Com um último esforço, esmago a última vela. Um silêncio súbito cai sobre o sótão.`,
                options: [
                    { text: "Aproximar-se de Clara", next: "final1", sanityChange: 10 },
                    { text: "Sair correndo do sótão", next: "final2", sanityChange: -10 }
                ]
            },
            
            // CENAS MELHORADAS - Não terminam o jogo, mas levam a situações perigosas
            confronto_sombra: {
                text: `Decido enfrentar a sombra. Avanço em direção a ela, mas antes que possa alcançá-la, algo me agarra por trás. Mãos frias e ossudas me imobilizam enquanto a sombra sem rosto se aproxima.

O vazio escuro onde seu rosto deveria estar se expande para me engolir. Sinto meu corpo ficar frio, minha mente começando a se dissipar...

De repente, ouço um barulho vindo de baixo - um estrondo que faz a mansão toda tremer. As mãos que me seguravam soltam por um instante. É minha chance!`,
                options: [
                    { text: "Correr escada abaixo enquanto posso", next: "entrada", sanityChange: -25, escape: true },
                    { text: "Empurrar a sombra e entrar no quarto", next: "quarto_sombra", sanityChange: -30 }
                ]
            },
            
            armadilha: {
                text: `Corro em direção a Clara, querendo abraçá-la, trazê-la de volta. Mas quando toco nela, suas mãos se fecham em meus pulsos com força sobrenatural.

"Obrigada", sussurra a voz que não é dela. "Precisava de um corpo novo. O dela já estava... gasto."

Sinto minha consciência se esvaindo, enquanto algo frio e antigo tenta invadir minha mente. Em um último esforço de sobrevivência, meus instintos assumem o controle. Dou um solavanco para trás, rompendo o contato. A coisa que habita Clara parece surpresa.

"Você é mais forte do que pensei", ela sussurra, enquanto eu recuo em direção à escada.`,
                options: [
                    { text: "Descer a escada correndo", next: "entrada", sanityChange: -20, escape: true },
                    { text: "Tentar destruir o círculo ritualístico", next: "quebrar_circulo", sanityChange: -25 }
                ]
            },
            
            quarto_sombra: {
                text: `Consigo empurrar a sombra e entro no quarto, fechando a porta atrás de mim. O quarto está vazio, exceto por uma janela quebrada. Posso ouvir a sombra arranhando a porta do lado de fora.

A janela leva a um telhado inclinado. Lá fora, a névoa está mais densa. Vejo que posso descer pelo telhado até uma varanda no andar de baixo.

A porta começa a ceder. Não tenho muito tempo.`,
                options: [
                    { text: "Pular pela janela para o telhado", next: "telhado", sanityChange: -15 },
                    { text: "Procurar algo para barrar a porta", next: "barricar_porta", sanityChange: -10 }
                ]
            },
            
            telhado: {
                text: `Saio pela janela e me encontro no telhado escorregadio da mansão. A neblina é tão densa que mal consigo ver o chão. Deslizo cuidadosamente até a beirada e vejo uma varanda logo abaixo.

Consigo pular para a varanda com algum esforço. Estou agora no segundo andar, em um corredor diferente. A sombra ainda deve estar no outro lado da mansão.

Ouço vozes sussurrantes vindo de uma das portas.`,
                options: [
                    { text: "Seguir as vozes", next: "vozes_corredor", sanityChange: -12 },
                    { text: "Descer as escadas para o hall principal", next: "entrada", sanityChange: -5 }
                ]
            },
            
            desistir: {
                text: `Decido que já chega. Clara provavelmente já se foi, e não há sentido em me arriscar também. Começo a sair da biblioteca, mas algo estranho acontece.

As portas não abrem. As janelas estão seladas como se tivessem sido pintadas por dentro. Tento forçar uma janela, mas ela não se move.

Uma risada ecoa pela biblioteca. Não é humana. "Você achou que poderia simplesmente ir embora?", uma voz sussurra nas sombras. "Você já está preso aqui, como todos os outros."`,
                options: [
                    { text: "Procurar desesperadamente por uma saída", next: "procura_saida", sanityChange: -15 },
                    { text: "Enfrentar o que está na biblioteca", next: "enfrentar_biblioteca", sanityChange: -20 },
                    { text: "Tentar queimar algo para criar uma distração", next: "distracao_fogo", condition: () => sanity > 40, sanityChange: -25 }
                ]
            },
            
            // Cenas de final (verdadeiros finais)
            final1: {
                text: `Clara cai no chão, inconsciente. Seus olhos voltaram ao normal. Quando ela acorda, minutos depois, está confusa, mas é ela de verdade.

Conduzo minha irmã para fora da mansão, que agora parece menos ameaçadora, como se tivesse perdido sua força.

Nunca entendemos completamente o que aconteceu na Mansão Blackwood, mas Clara está viva e segura. Às vezes, ainda acordo no meio da noite, pensando ter ouvido sussurros vindos das paredes... mas pelo menos estamos juntos.`,
                options: [
                    { text: "Jogar novamente", next: "restart" }
                ]
            },
            
            final2: {
                text: `Corro escada abaixo, deixando Clara para trás. Quando saio da mansão, olho para trás uma última vez e vejo uma figura na janela do sótão, observando minha fuga.

Volto para casa sozinho. A polícia não acredita na minha história. Clara é declarada morta, mas eu sei a verdade: algo ainda a mantém presa naquela mansão.

Todas as noites sonho com ela, batendo nas paredes do sótão, tentando escapar. E sei que um dia vou ter que voltar.`,
                options: [
                    { text: "Jogar novamente", next: "restart" }
                ]
            },
            
            // Cena fallback padrão
            fallback: {
                text: `Algo deu errado. Você se perdeu nas profundezas da mansão. O ar está frio e a escuridão é absoluta. Você precisa encontrar uma saída.`,
                options: [
                    { text: "Continuar", next: "entrada" }
                ]
            }
        };

        // Adicionando mais cenas para completar o jogo
        scenes.corredor = {
            text: `O corredor é estreito e parece se estender além do alcance da minha lanterna. As paredes estão cobertas por um papel de parede desbotado que se desprende em tiras.

De repente, sinto uma corrente de ar gelada. Alguém - ou algo - está respirando perto do meu ouvido. Viro-me rapidamente, mas não vejo nada.

No final do corredor, uma porta entreaberta emite uma luz fraca e pulsante. De outro lado, ouço o som de choramingo suave.`,
            options: [
                { text: "Seguir em direção à luz pulsante", next: "luz_corredor", sanityChange: -12 },
                { text: "Investigar o som de choramingo", next: "choramingo", sanityChange: -15 },
                { text: "Voltar para o hall de entrada", next: "entrada", sanityChange: -5 }
            ]
        };

        scenes.janela = {
            text: `Subo em uma caixa de ferramentas enferrujada para olhar pela janela iluminada. O que vejo me paralisa de terror.

Dentro do quarto, vejo várias figuras em pé, imóveis, de costas para a janela. Elas estão dispostas em um círculo. No centro, uma criatura esquelética com membros muito longos se contorce de maneira não natural.

De repente, todas as figuras se viram ao mesmo tempo. Seus rostos são vazios, sem características. E todas estão olhando diretamente para mim.`,
            options: [
                { text: "Descer rapidamente e fugir", next: "fundos", sanityChange: -25, escape: true },
                { text: "Continuar observando", next: "observar_janela", sanityChange: -30 },
                { text: "Tentar quebrar a janela", next: "quebrar_janela", sanityChange: -20 }
            ]
        };

        // Funções do jogo
        function showScene(sceneId) {
            // Salvar a cena anterior antes de mudar
            if (sceneId !== "restart" && scenes[sceneId]) {
                previousScene = sceneId;
            }
            
            const scene = scenes[sceneId] || scenes.fallback;
            const sceneTextElement = document.getElementById('scene-text');
            const optionsContainer = document.getElementById('options-container');
            const sceneContainer = document.getElementById('scene-container');
            
            // Atualizar texto da cena
            sceneTextElement.textContent = scene.text;
            sceneTextElement.classList.remove('typing');
            void sceneTextElement.offsetWidth; // Trigger reflow
            sceneTextElement.classList.add('typing');
            
            // Limpar opções anteriores
            optionsContainer.innerHTML = '';
            
            // Adicionar classe de perigo se for uma cena de escape
            if (scene.options && scene.options.some(opt => opt.escape)) {
                sceneContainer.classList.add('danger');
                sceneTextElement.classList.add('danger-text');
            } else {
                sceneContainer.classList.remove('danger');
                sceneTextElement.classList.remove('danger-text');
            }
            
            // Filtrar opções disponíveis com base nas condições
            let availableOptions = scene.options.filter(option => {
                return !option.condition || option.condition();
            });
            
            // Se não houver opções disponíveis, criar uma opção de fallback
            if (availableOptions.length === 0) {
                availableOptions = [{ text: "Continuar", next: previousScene || "entrada" }];
            }
            
            // Adicionar opções ao container
            availableOptions.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-button';
                if (option.escape) {
                    button.classList.add('escape-option');
                }
                
                button.innerHTML = `<span>${option.text}</span>`;
                
                button.addEventListener('click', () => {
                    // Aplicar mudança de sanidade, se houver
                    if (option.sanityChange) {
                        updateSanity(option.sanityChange);
                    }
                    
                    // Ir para próxima cena
                    if (option.next === "restart") {
                        restartGame();
                    } else {
                        showScene(option.next);
                    }
                });
                
                optionsContainer.appendChild(button);
            });
            
            // Atualizar estado do jogo
            gameState.currentScene = sceneId;
        }
        
        function updateSanity(value) {
            sanity += value;
            
            // Limitar sanidade entre 0 e 100
            sanity = Math.max(0, Math.min(100, sanity));
            
            // Atualizar display
            const sanityValueElement = document.getElementById('sanity-value');
            const sanityFillElement = document.getElementById('sanity-fill');
            
            sanityValueElement.textContent = `${sanity}%`;
            sanityFillElement.style.width = `${sanity}%`;
            
            // Alterar cor se a sanidade estiver baixa
            if (sanity < 30) {
                sanityFillElement.classList.add('sanity-low');
                document.getElementById('scene-container').classList.add('flicker');
            } else {
                sanityFillElement.classList.remove('sanity-low');
                document.getElementById('scene-container').classList.remove('flicker');
            }
            
            // Game over se a sanidade chegar a 0
            if (sanity <= 0) {
                gameOver("SANIDADE ESGOTADA", "A mansão consumiu sua mente. Você agora vagueia pelos corredores, um eco vazio do que um dia foi, preso para sempre nas memórias da Mansão Blackwood.");
            }
        }
        
        function gameOver(title, text) {
            const sceneContainer = document.getElementById('scene-container');
            sceneContainer.innerHTML = `
                <div class="game-over">
                    <h2>${title}</h2>
                    <p>${text}</p>
                    <button class="restart-button" id="restart-button">TENTAR NOVAMENTE</button>
                </div>
            `;
            
            document.getElementById('restart-button').addEventListener('click', restartGame);
        }
        
        function restartGame() {
            // Resetar estado do jogo
            sanity = 100;
            gameState = {};
            previousScene = null;
            
            // Atualizar display de sanidade
            const sanityValueElement = document.getElementById('sanity-value');
            const sanityFillElement = document.getElementById('sanity-fill');
            
            sanityValueElement.textContent = "100%";
            sanityFillElement.style.width = "100%";
            sanityFillElement.classList.remove('sanity-low');
            document.getElementById('scene-container').classList.remove('flicker');
            document.getElementById('scene-container').classList.remove('danger');
            
            // Voltar para a cena inicial
            showScene("start");
        }
        
        // Inicializar o jogo quando o DOM estiver carregado
        document.addEventListener('DOMContentLoaded', () => {
            showScene("start");
        });
    </script>
</body>
</html>